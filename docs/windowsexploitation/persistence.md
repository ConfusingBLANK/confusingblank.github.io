# Windows Persistence Techniques

The purpose of persistence is to maintain your access after a reboot or process termination.

## Startup Folder and Registry Key Runs

Don't need local admin to use these techniques.

Copy or place the executable in the startup folder. I think you can also use a shortcut in the StartUp Folder?

```
copy implant.exe "%APPDATA%\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\"
```

Clean up by removing file from the startup folder.

Registry Persistence. Can also place in the HKEY_CURRENT_MACHINES path but for that you need to be running as local admin/high integrity. You can test these on your local system by rebooting the system or logging out and logging back in to check if the payload executes.

```
reg add "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run" /v MSUpdate /t REG_SZ /d C:\path\to\exe /f
```

Claen up with:
```
reg delete "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run" /v MSUpdate /f
```